scalar AWSDateTime
scalar AWSEmail
scalar AWSJSON
scalar AWSPhone
scalar AWSURL

# Hub types ---------------------------------------------
type Hub {
  hubId: ID!
  name: String!
  latitude: Float!
  longitude: Float!
  radius: Int! # in meters
  hubType: HubType!
  createdBy: ID!
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
  description: String!
  isActive: Boolean!
  memberCount: Int!
  geohash: String!
  
  # Will implement later:
  # markers: [HubMarker]
  # inviteCode: String
  # qrCode: String
  # polygon: String
}

enum HubType {
  PUBLIC
  PRIVATE
}

input CreateHubInput {
  name: String!
  description: String!
  latitude: Float!
  longitude: Float!
  radius: Int!
  hubType: HubType!
}

# User Types ---------------------------------------------
type User {
  userId: ID!
  profile: UserProfile!
  preferences: UserPreferences!
  joinedAt: AWSDateTime!
  currentHub: String
  favoriteHubs: [FavoriteHub!]!
  blockedUsers: [String!]
  updatedAt: AWSDateTime!
}

type UserProfile {
  displayName: String
  bio: String
}

type UserPreferences {
  theme: Theme!
  notifications: Boolean!
  locationSharing: LocationSharing!
  profileVisibility: ProfileVisibility!
  isAnonymous: Boolean!
}

type FavoriteHub {
  name: String!
  hubId: String!
}

enum Theme {
  LIGHT
  DARK
  AUTO
}

enum LocationSharing {
  OFF
  ON
}

enum ProfileVisibility {
  PUBLIC
  FRIENDS
  PRIVATE
}

input CreateUserInput {
  displayName: String!
  bio: String
}

input UpdateUserPreferencesInput {
  theme: Theme
  notifications: Boolean
  locationSharing: LocationSharing
  profileVisibility: ProfileVisibility
  isAnonymous: Boolean
}

input UpdateProfileInput {
  displayName: String
  bio: String 
}

# Memberships
type Membership {
  hubId: ID!
  userId: ID!
  joinedAt: AWSDateTime!
  lastSeen: AWSDateTime!
}

input AddMemberInput {
  hubId: ID!
}

input RemoveMemberInput {
  hubId: ID!
}

type Query {
  # Hub queries
  getHub(hubId: ID!): Hub

  getNearbyHubs(
    latitude: Float!
    longitude: Float!
    radiusKm: Float = 3.0
    limit: Int = 50
    hubType: HubType
  ): [Hub!]!

  # Will implement later:
  # getNearbyHubs(latitude: Float!, longitude: Float!, radiusKm: Float): [Hub]
  # searchHubs(query: String!, latitude: Float, longitude: Float): [Hub]

# User queries
  getMe: User

  getUserProfile(userId: ID!): UserProfile
}
  
type Mutation {
  # Hub mutations
  createHub(input: CreateHubInput!): Hub!

  deleteHub(hubId: ID!): Boolean!

  # Will implement later:
  # updateHub(hubId: ID!, input: UpdateHubInput!): Hub!

  # User mutations
  createUser(input: CreateUserInput!): User!

  updateProfile(input: UpdateProfileInput!): UserProfile!

  updateUserPreferences(input: UpdateUserPreferencesInput!): UserPreferences!

  # Members
  addMember(input: AddMemberInput!): Membership!

  removeMember(input: RemoveMemberInput!): Boolean!
}

# type Subscription {
#   # Will implement later:
#   # onHubCreated: Hub @aws_subscribe(mutations: ["createHub"])
#   # onHubUpdated(hubId: ID!): Hub @aws_subscribe(mutations: ["updateHub"])
#   # onHubDeleted: ID @aws_subscribe(mutations: ["deleteHub"])
# }